import nodemailer from "nodemailer";
import { config } from "../config/config";

//creating nodemailer transporter for sending confirmation link mail
export const confirmationEmail = async (
  secretToken: string,
  userAddress: string
) => {
  try {
    let transporter =  await nodemailer.createTransport({
      service: "gmail", // using gmail as mail service for testing
      auth: {
        user: config.email,
        pass: config.pass,
      },
    });
  
    const confirmURL = `bitpayroll.vercel.app/activate/${secretToken}`;
    // setup email data with unicode symbols
    const mailOptions = {
      from: process.env.EMAIL,
      to: userAddress,
      subject: "Confirm your account",
      html: `<div style="width: 100%; height: 100%; background-color: #f2f2f2; padding: 20px;">
      <div style="width: 100%; max-width: 600px; margin: auto; background-color: white; padding: 20px;">
        <div style="width: 100%; text-align: center;">
          <h1 style="font-size: 30px; color: #1e90ff;">Welcome to the team!</h1>
          <p style="font-size: 20px; color: #1e90ff;">Please confirm your email address to complete your registration.</p>
        </div>  
        <div style="width: 100%; text-align: center;">
  
          <a href="${confirmURL}" style="text-decoration: none; background-color: #1e90ff; color: white; padding: 10px 20px; border-radius: 5px; font-size: 20px;">Confirm</a>
        </div>
      </div>
    </div>`,
    };
  
    await transporter.sendMail(mailOptions);
    
  } catch (error) {
    throw new Error(error);
  }
};
